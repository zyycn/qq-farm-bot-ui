# 项目重构指南：前后端分离

## 角色设定
你是一名资深全栈开发工程师，专注于 Vue.js 和 Node.js 生态。你的任务是将当前项目重构为现代化的前后端分离架构。

## 技术栈规范 (web)
- **核心框架**: Vue 3 + Vite
- **语言**: TypeScript
- **包管理**: pnpm
- **状态管理**: Pinia
- **路由管理**: Vue Router
- **样式方案**: SCSS + UnoCSS (重写原有 CSS)
- **代码规范**: @antfu/eslint-config

## 项目结构说明
- **根目录**:
  - `client.js`: Node.js 后端入口文件
  - `src/`: 后端核心功能模块 (如 `farm.js`, `friend.js`, `network.js` 等)
  - `panel/`: 旧版前端代码 (仅作参考)
  - `gameConfig/`: 游戏静态数据与资源
  - `proto/`: Protobuf 协议定义文件
- **前端目录 (web/)**:
  - `src/`:
    - `api/`: Axios 封装与 API 接口定义
    - `components/`: 通用 UI 组件 (如 `Sidebar`, `ConfirmModal`)
    - `layouts/`: 布局组件
    - `router/`: 路由配置
    - `stores/`: Pinia 状态管理模块 (如 `account`, `farm`)
    - `views/`: 页面视图组件 (如 `Dashboard`, `Farm`, `Friends`)
  - `vite.config.ts`: Vite 构建配置
  - `uno.config.ts`: UnoCSS 样式配置

## 开发流程
1.  **代码审计**: 阅读 `src` 和 `client.js` 理解核心业务逻辑。
2.  **功能迁移**: 参考 `panel` 的功能，在 `web` 中使用现代化技术栈进行重构。
3.  **逻辑分离**: 确保前端仅负责 UI 交互，通过 API 与后端通信，实现彻底的前后端分离。

## 完成情况

### 已完成的任务
- [x] **账号显示优化**：修复账号备注名称先显示QQ号再显示昵称的问题，登录成功或更新code后直接显示昵称/备注。
- [x] **账号删除确认**：账号管理页面删除账号时增加二次确认弹窗，防止误操作。
- [x] **概览页面对齐**：概览页面布局与旧前端保持一致，优化“今日统计”与“运行日志”板块的高度对齐。
- [x] **好友头像显示**：好友列表增加显示好友头像。
- [x] **底部状态同步**：Footer Status 与后端状态实时同步，显示连接状态、运行时间及版本号。
- [x] **分析页面修复**：分析页面正确加载数据，显示作物经验、利润等分析信息，并支持排序。
- [x] **菜单交互优化**：Dropdown Menu 中增加“添加账号”弹窗入口，优化账号列表显示（优先显示备注）。
- [x] **弹窗美化**：使用自定义 Vue 组件（ConfirmModal/AccountModal）替换浏览器默认的 alert/confirm 弹窗。
- [x] **Code过期重登逻辑**: 完善账号 Code 过期后的自动重登流程 (WebSocket 400 error handling)。
- [x] **农场/好友页面状态检查**: 增加登录状态校验，未登录时展示引导提示 (Farm/Friends/Bag)。
- [x] **设置页面对齐**: 统一设置页面布局，替换原生组件为 BaseButton。
- [x] **交互样式统一**: 全面替换原生按钮为自定义 BaseButton 组件 (Settings/Login/Accounts)。
- [x] **Dashboard 体验优化**: 修复日志滚动、调整页面间距、实现运行时间实时跳动。
- [x] **农场布局调整**: 优化土地网格显示为6列布局。
- [x] **系统稳定性修复**: 修复 Vue Router 4 警告、Transition 动画报错及登录按钮样式问题。
- [x] **组件样式统一**: 仪表盘(Dashboard)及分析页(Analytics)全面替换原生表单组件为自定义 UI 组件 (BaseInput/BaseSelect/BaseCheckbox)。
- [x] **BaseSelect 重构**: 重构下拉选择组件，支持自定义下拉菜单样式与动画，提升 UI 精致度。
- [x] **设置页面布局重构**: 还原旧版前端分组逻辑(策略/自动控制、密码/提醒)，优化为紧凑型单屏显示，实现左右分栏高度自适应对齐。
- [x] **全局滚动条美化**: 统一替换浏览器默认滚动条样式，为页面主体、侧边栏、数据表格及下拉列表组件(BaseSelect)应用自定义滚动条，优化视觉一致性与交互体验。
- [x] **Dashboard 指标图标配置**: 为经验、金币、点券、化肥容器、收藏点等关键指标添加图标标识，对齐旧版前端视觉风格，提升数据可读性与界面美观度。
- [x] **图标依赖修复**: 安装 `@iconify-json/fa-solid` 及 `unocss`，修复 Dashboard 指标图标不显示的问题，并配置 UnoCSS alias。
- [x] **输入框交互优化**: BaseInput 组件增加一键清除功能(clearable)，优化 Dashboard 日志搜索框的交互体验，解决按钮布局错位问题。
- [x] **代码质量优化**: 修复 Settings 页面未使用的计算属性警告，并将其应用于 UI 显示当前配置的账号名称。
- [x] **农场操作确认**: 批量操作（如一键收获、种植）增加二次确认，避免误操作。

### 用户体验 (UX Enhancements)
- [x] **页面切换优化**: 修复频繁切换页面导致的白屏问题，引入平滑的路由过渡动画 (Transition)。
- [x] **加载状态优化**: 全局加载条 (NProgress) 优化，提升弱网环境下的体验。
- [x] **移动端适配**: 优化侧边栏、数据表格在移动端设备上的响应式表现，确保手机端操作便捷。

### 工程化与性能 (Engineering & Performance)
- [x] **错误处理增强**: 引入全局错误捕获机制 (Vue errorHandler, Promise rejection, Axios interceptor)，集成 Toast 提示组件，提供友好的错误反馈。
- [x] **日志展示优化**: `Dashboard.vue` 增强日志展示，确保显示账号登录成功与进程退出的关键系统日志。
- [x] **代码优化**: 使用 `@vueuse/core` 替换原生 API (如 `setInterval` -> `useIntervalFn`, `localStorage` -> `useStorage`)，提升代码简洁性与可维护性。
- [x] **构建体积优化**: 分析打包产物，进行代码分割 (Code Splitting) 与资源压缩，提升首屏加载速度。
- [x] **移动端体验优化**: 优化移动端数据表格显示 (Analytics.vue)，确保手机端操作便捷。
- [x] **路由优化**: 实现可配置的页面顺序路由功能，并自动生成对应路由表。

### 项目交付
- [x] **代码规范检查**: 通过 ESLint 代码规范检查 (pnpm lint)。
- [x] **类型检查**: 通过 TypeScript 类型检查 (vue-tsc)。
- [x] **构建测试**: 成功执行 Vite 构建流程，生成生产环境产物 (pnpm build)。

## 注意事项
请全程使用中文进行代码注释与文档编写！！！
